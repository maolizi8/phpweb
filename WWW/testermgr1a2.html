<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>测试资源管理</title>
   	<link rel="stylesheet" type="text/css" href="cxtester/css/bootstrap.min.css" />
   	
   	<script src="cxtester/js/jquery-2.0.3.min.js" type="text/javascript" charset="utf-8"></script>
	<script src="cxtester/js/jquery-2.1.0.js" type="text/javascript" charset="utf-8" ></script>
	<script src="cxtester/js/bootstrap.min.js" type="text/javascript" charset="utf-8"></script>
	<script src="cxtester/layer/layer.js"  type="text/javascript" charset="utf-8"></script>
	
	
</head>
<body>
	<div class="container">	
	<h2 style="align-content: center; width: 100%;" align="center">测试资源管理</h2>	
	<table border="1" cellspacing="1" cellpadding="1" style=" width: 100%;" id="alltrm" class="table">
			<tr>
				<th>序号</th>
				<th>用户id</th>
				<th>姓名</th>
				<th>状态</th>
				<th>计划项目</th>
				<th>开始时间</th>
				<th>结束时间</th>
				<th>技能</th>
				<th>项目状态</th>
				<th width="200px">操作</th>
			</tr>
			<tbody  id="tablebody" >
				
			</tbody>
			
	</table>
	
	<div id="paginator" class="pagination"></div>
		
	</div>
	

	<script type="text/javascript">	
	var pageNum=1;
	
	//var pageDisp="";
	var pageTotal= 0;
		
	$(function() { 
		$.ajax({
				type: "post", 
				url: "cxtester/pages.php?page="+pageNum,
				async: true, 
				success: function(data) {
					var dataProj = eval(data);
					console.log(dataProj);
					var len=dataProj.length-1;
					console.log(len);
					var html="";
					for(var i = 0, len; i< len; i++){
																			
						html+="<tr id='ptr_"+i+"'>";
						html+="<td align='center'>"+(i+1)+"</td>";
						html+="<td align='center'>"+dataProj[i].tid+"</td>";
						html+="<td align='center'>"+dataProj[i].tname+"</td>";
						//html+="<td>"+dataProj[i].tstatus+"</td>";
						if(dataProj[i].tstatus==0){
							var j="可用";
							html+="<td align='center'>"+j+"</td>";
						}else{
							var j="锁定";
							html+="<td align='center' style='color:#FA8072;font-weight:bold'>"+j+"</td>";
						}
						html+="<td align='center'>"+(dataProj[i].pproject||'')+"</td>";
						html+="<td align='center'>"+(dataProj[i].pstart||'')+"</td>";
						html+="<td align='center'>"+(dataProj[i].pcomplete||'')+"</td>";
						html+="<td align='center'>"+(dataProj[i].tskill||'')+"</td>";
						if(dataProj[i].pstatus==0){
							var j="未开始";
							html+="<td align='center'>"+j+"</td>";
						}else if(dataProj[i].pstatus==1){
							var j="进行中";
							html+="<td align='center'>"+j+"</td>";
						}else if(dataProj[i].pstatus==null){
							var j="";
							html+="<td align='center'>"+(j||'')+"</td>";
						}else{
							var j="已结束";
							html+="<td align='center'>"+j+"</td>";
						}
						
						html+="<td>";
						//html+="<button type='button' data-delprid='"+dataProj[i].pid+"' data-deltesterid='"+dataProj[i].tid+"' data-deltrid='"+i+"' class='delProj' data-target='#delProject'>删除</button>";
						html+="<button type='button'>删除</button>";
						html+="</td>"
						html+="</tr>";
					}
					$("#tablebody").append(html);
					
					//page
					pageTotal=dataProj[len].pageTotal;
					console.log("pageTotal="+pageTotal);
					var pageDisp="";
					pageDisp+="<ul class='pagination'><li><a href='#'>&laquo;</a></li>";
					pageDisp+="<li class='active'><a href='#'>1</a></li>";
					for(var i=1,pageTotal;i<pageTotal;i++){
						var j=i+1;
						pageDisp+="<li><a href='#' onclick='pagenum("+j+")'>"+j+"</a></li>";
					}
	    			pageDisp+="<li><a href='#'>&raquo;</a></li>";
					pageDisp+="</ul> ";
					$("#paginator").append(pageDisp);
				}
			});
		})
	
	function pagenum(numb){
		$.ajax({
				type: "post", 
				url: "cxtester/pages.php?page="+numb,
				async: true, 
				success: function(data) {
					
					$("#tablebody").empty();
					$("#paginator").empty();
					
					var dataProj = eval(data);
					console.log(dataProj);
					var len=dataProj.length-1;
					console.log(len);
					var html="";
					for(var i = 0, len; i< len; i++){
																			
						html+="<tr id='ptr_"+i+"'>";
						html+="<td align='center'>"+(i+1)+"</td>";
						html+="<td align='center'>"+dataProj[i].tid+"</td>";
						html+="<td align='center'>"+dataProj[i].tname+"</td>";
						//html+="<td>"+dataProj[i].tstatus+"</td>";
						if(dataProj[i].tstatus==0){
							var j="可用";
							html+="<td align='center'>"+j+"</td>";
						}else{
							var j="锁定";
							html+="<td align='center' style='color:#FA8072;font-weight:bold'>"+j+"</td>";
						}
						html+="<td align='center'>"+(dataProj[i].pproject||'')+"</td>";
						html+="<td align='center'>"+(dataProj[i].pstart||'')+"</td>";
						html+="<td align='center'>"+(dataProj[i].pcomplete||'')+"</td>";
						html+="<td align='center'>"+(dataProj[i].tskill||'')+"</td>";
						if(dataProj[i].pstatus==0){
							var j="未开始";
							html+="<td align='center'>"+j+"</td>";
						}else if(dataProj[i].pstatus==1){
							var j="进行中";
							html+="<td align='center'>"+j+"</td>";
						}else if(dataProj[i].pstatus==null){
							var j="";
							html+="<td align='center'>"+(j||'')+"</td>";
						}else{
							var j="已结束";
							html+="<td align='center'>"+j+"</td>";
						}
						
						html+="<td>";
						//html+="<button type='button' data-delprid='"+dataProj[i].pid+"' data-deltesterid='"+dataProj[i].tid+"' data-deltrid='"+i+"' class='delProj' data-target='#delProject'>删除</button>";
						html+="<button type='button'>删除</button>";
						html+="</td>"
						html+="</tr>";
					}
					
					$("#tablebody").append(html);
					
					//page
					pageTotal=dataProj[len].pageTotal;
					console.log("pageTotal="+pageTotal);
					var pageDisp="";
					pageDisp+="<ul class='pagination'><li><a href='#'>&laquo;</a></li>";
					for(var i=0;i<numb-1;i++){
						var j=i+1;
						pageDisp+="<li><a href='#' onclick='pagenum("+j+")'>"+j+"</a></li>";
					}
					pageDisp+="<li class='active'><a href='#'>"+numb+"</a></li>";
					
					for(var i=numb,pageTotal;i<pageTotal;i++){
						var j=i+1;
						pageDisp+="<li><a href='#' onclick='pagenum("+j+")'>"+j+"</a></li>";
					}
	    			pageDisp+="<li><a href='#'>&raquo;</a></li>";
					pageDisp+="</ul> ";
					$("#paginator").append(pageDisp);
				}
			});
			
	}
	</script>
	
	
</body>
</html>